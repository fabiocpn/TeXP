bases.raw=read.table("ref.prop")
bases
bases.raw
colSums(bases.raw)
colSums(bases.raw$V2)
sum(bases.raw$V2)
counts.prop=bases.raw/sum(bases.raw$V2)
counts.prop=bases.raw$v2/sum(bases.raw$V2)
counts.prop=bases.raw$V2/sum(bases.raw$V2)
counts.prop
counts.prop=cbind(bases.raw$V1,bases.raw$V2/sum(bases.raw$V2))
counts.prop
counts.prop=cbind(bases.raw$V1,bases.raw$V2/sum(bases.raw$V2))
bases.raw$V1
counts.prop=cbind(bases.raw$V1,bases.raw$V2/sum(bases.raw$V2))
counts.prop
counts.prop$V2=cbind(bases.raw$V2/sum(bases.raw$V2))
counts.prop$V2=bases.raw$V2/sum(bases.raw$V2)
counts.prop
counts.prop$V1=bases.raw$V1
counts.prop
head(counts.prop
)
bases.raw=read.table("ref.prop",rownames=1)
bases.prop=ead.table("ref.prop",row.names=1)
head(bases.raw)
counts.prop=bases.raw/sum(bases.raw)
counts.prop
library(ggplot2)
pdf("~/temp.pdf")
ggplot()+geom_bar(data=bases.prop,aes(y=V1))
ggplot()+geom_bar(data=counts.prop,aes(y=V1))
head(counts.prop)
ggplot()+geom_bar(data=counts.prop,aes(y=V2))
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop))
)
dev.off()
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop),stat="identity")
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop),stat="identity"))
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")
dev.off()
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=16))
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=16))
dev.off()
pdf("~/temp.pdf",width=20)
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=16))
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=3))
dev.off()
sort(counts.prop)
sort(counts.prop,V2)
sort(counts.prop,counts.prop$V2)
count.prop(order(V2),)
count.props[order(V2),]
counts.prop[order(),]
head(counts.prop)
count.props[order(count.props$V2),]
count.props[order(count.props$V2),]
count.props[order(count.props),]
counts.props[order(counts.props$V2),]
counts.prop[order(counts.prop$V2),]
counts.prop=counts.prop[order(counts.prop$V2),]
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=3))
counts.prop=bases.raw/sum(bases.raw)
counts.prop
counts.prop[order(V2),]
attach(counts.prop)
counts.prop
counts.prop[order(V2),]
counts.prop2=counts.prop[order(V2),]
rownames(counts.prop2)
rownames(counts.prop2)=rownames(counts.prop)
counts.prop2=counts.prop[order(counts.prop2$V2),]
counts.prop2=counts.prop[order(counts.prop$V2),]
counts.prop2
head(counts.prop2)
rownames(counts.prop)
counts.prop2=counts.prop[order(counts.prop$V2),,drop=FALSE]
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=3))
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(names="LTR Subfamily")+scale_y_continuous(names="% of reads aligned to LTRs")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(names="% of reads aligned to LTRs")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
counts.prop2
write(file="counts.prop2",counts.prop2)
write(counts.prop2,"counts.prop2")
write.table(counts.prop2,"counts.prop2",quote=FALSE)
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
library(ggplot2)
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
counts.prop
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
counts.prop2=counts.prop[order(counts.prop$V2),,drop=FALSE]
counts.prop2
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
counts.prop2=counts.prop[order(counts.prop$V2),,drop=FALSE]
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off90
dev.off()
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
rownames(counts.prop2)
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop2))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop2))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
rownames(counts.prop2)
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop))+scale_y_continuous(name="% of reads aligned to LTRs")
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop))+scale_y_continuous(name="% of reads aligned to LTRs")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop2))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=rownames(counts.prop2)),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",breaks=rownames(counts.prop2),labels=rownames(counts.prop2))+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
counts.prop2$V3=rownames(counts.prop2)
head(counts.prop2)
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=V3,stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=V3),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=V3),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily")+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=V3),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",limits=V3)+scale_y_continuous(name="% of reads aligned to LTRs")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=V3),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",limits=counts.prop2$V3)+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
pdf("~/temp.pdf")
ggplot()+geom_bar(data=counts.prop2,aes(y=V2,x=V3),stat="identity")+theme(axis.text.x = element_text(angle=90, vjust=0.5, size=2))+scale_x_discrete(name="LTR Subfamily",limits=counts.prop2$V3)+scale_y_continuous(name="% of reads aligned to LTRs")
dev.off()
